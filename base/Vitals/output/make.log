
 make.py started: 2020-03-07 16:48:15 C:\Users\dgentil1\Desktop\aborto_uru_repo\Aborto-Uruguay\base\Vitals\code 




Execute:  "C:\Program Files (x86)\Stata14\StataSE-64.exe" /e do "./vital_records.do"

  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   14.2   Copyright 1985-2015 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     Special Edition                  College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

110-user Stata network perpetual license:
       Serial number:  401406206058
         Licensed to:  CIS Department
                       Brown University

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  Maximum number of variables is set to 5000; see help set_maxvar.

. do ./vital_records.do 

. clear all

. set more off

. adopath + ../../../library/stata/gslab_misc/ado
  [1]  (BASE)      "C:\Program Files (x86)\Stata14\ado\base/"
  [2]  (SITE)      "C:\Program Files (x86)\Stata14\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../library/stata/gslab_misc/ado"

. 
. program main    
  1.     append_years
  2.     gen_vars
  3.     label_vars
  4. 
.     gen birth_id = _n
  5.     drop if missing(dpto)
  6.         drop if edadm == 99
  7.     keep birth_id anio anio_sem anio_qtr dpto dpto_residence pereira publi
> c_health ///
>         edadm young adult age_group age_min age_max married not_married partn
> er no_partner single ///
>         prim_school high_school recomm_prenatal_numvisits ///
>         recomm_prenatal_1stvisit no_prenatal_care first_pregnancy kids_before
>  ///
>         lowbirthweight apgar1_low apgar2_low preg_preterm 
  8.     save_data ../output/vital_birth_records.dta, key(birth_id) replace
  9. end

. 
. program append_years
  1.     * Note: there is no 1998 data, but there is data for 1996 and 1997
.     forvalues year = 1999/2015 {
  2.         capture import delimited "../../../raw/vital_records/Natalidad `ye
> ar'_p.csv", delim(";") clear
  3. 
.         qui destring , replace
  4.         
.         tempfile temp_`year'
  5.         save `temp_`year''
  6.     }
  7. 
.     forvalues year = 1999/2014 {
  8.         append using `temp_`year''
  9.     }
 10. 
.     keep if inrange(anio_parto,1999,2015) //note some births in 2015 are reco
> rded in 2016
 11.     
.     save "../temp/births_append.dta", replace
 12. end

. 
. program gen_vars
  1.     use "../temp/births_append.dta", clear
  2.     rename anio_parto anio
  3. 
.     * Add variable dpto coded as in the ECH
.     gen     dpto = codep   if inrange(codep,11,19)
  4.     replace dpto = 1       if codep==10
  5.     replace dpto = codep+1 if inrange(codep,1,9)
  6.     drop codep
  7.     
.     gen     dpto_residence = depar   if inrange(depar,11,19)
  8.     replace dpto_residence = 1       if depar==10
  9.     replace dpto_residence = depar+1 if inrange(depar,1,9)
 10.     drop depar
 11. 
.     * Assert that corresponding variables are not used at the same time & Gen
>  harmonized vars
.     * Note: issue with mademay == 4 : table anio madeult if mademay == 4
.     assert (mi(civilm) & !mi(mestciv) & !mi(tunion)) | (!mi(civilm) & mi(mest
> civ) & mi(tunion))
 12.     assert (mi(instm) & !mi(mademay) & !mi(madecur) & !mi(madeult)) | (!mi
> (instm) & mi(mademay) & mi(madecur) & mi(madeult))
 13.     gen married     = (civilm==2 | mestciv==2)                           i
> f civilm!=9 & mestciv!=9
 14.     gen not_married = (married==0)                                       i
> f !mi(married)
 15.     gen partner     = (inlist(civilm,2,3)|mestciv==2|inlist(tunion,1,2)) i
> f civilm!=9 & mestciv!=9
 16.     gen no_partner  = (partner==0)                                       i
> f !mi(partner)
 17.     gen single      = (inlist(civilm,1,4,5,6))|(tunion==9|mestciv==2)    i
> f civilm!=9 & mestciv!=9 
 18.     gen     prim_school = (instm==2|((mademay==2 & madeult==6)|(mademay==4
>  & madeult<3)|mademay==3)) if instm!=9 | mademay!=9 | madeult!=9
 19.     gen     high_school = (instm==3|((mademay==4 & madeult==3)|(mademay==5
>  & madeult==1)))           if instm!=9 | mademay!=9 | madeult!=9
 20.     replace high_school = 1 if inrange(anio,2008,2010) & mademay==4 & made
> ult==6 
 21.     
.     * Birth date
.     drop if mi(fecparto)
 22.     replace fecparto = "jan" + substr(fecparto,4, .) if substr(fecparto, 1
> , 3) == "ene"
 23.     replace fecparto = "apr" + substr(fecparto,4, .) if substr(fecparto, 1
> , 3) == "abr"
 24.     replace fecparto = "aug" + substr(fecparto,4, .) if substr(fecparto, 1
> , 3) == "ago"
 25.     replace fecparto = "dec" + substr(fecparto,4, .) if substr(fecparto, 1
> , 3) == "dic"
 26.     gen     anio_mon = monthly(fecparto, "MY")
 27.     replace anio_mon = monthly(fecparto, "M20Y")
 28.     assert !mi(anio_mon) if !mi(fecparto)
 29.     format  anio_mon %tm 
 30.     gen     anio_qtr = qofd(dofm(anio_mon))
 31.     format  anio_qtr %tq
 32.     gen     anio_sem = hofd(dofm(anio_mon))
 33.     format  anio_sem %th
 34.     
.     * Pregnancy vars
.     gen recomm_prenatal_numvisits = (totcons>5) if !mi(totcons) & totcons!=99
 35.     gen recomm_prenatal_1stvisit  = (semprim<13) if !inlist(semprim,97,99)
 36.     gen no_prenatal_care          = (totcons==0 | semprim==97) if totcons!
> =99
 37.     gen first_pregnancy           = (numemban==0) if numemban!=99
 38.     gen kids_before               = (first_pregnancy==0) if !mi(first_preg
> nancy)
 39.     gen lowbirthweight            = (peso<2500) if !mi(peso)   & peso<9999
 40.     gen apgar1_low                = (apgar1<7)  if !mi(apgar1) & inrange(a
> pgar1,1,10)
 41.     gen apgar2_low                = (apgar2<7)  if !mi(apgar2) & inrange(a
> pgar2,1,10)
 42.     gen preg_preterm              = (semgest<37) if !mi(semgest) & semgest
> !=99
 43. 
.     * age vars
.     gen young         = inrange(edadm,15,30)
 44.     gen adult         = inrange(edadm,31,44)
 45.     egen age_group    = cut(edadm) , at(10(5)60)
 46.     bys age_group: egen age_min = min(edadm) if !missing(age_group)
 47.         bys age_group: egen age_max = max(edadm) if !missing(age_group)
 48.         
.     lab def young                 0 "Age: 31-45"             1 "Age: 16-30"
 49.     lab val young                 young
 50.     
.         gen public_health = (tipoestab == 1)
 51.         gen pereira = (estab2 == 77 & dpto == 1)
 52. end

. 
. program label_vars
  1.     lab def not_married               0 "Married"                1 "Not ma
> rried"
  2.     lab val not_married               not_married
  3.     lab def no_partner                0 "With partner"           1 "Withou
> t partner"
  4.     lab val no_partner                no_partner
  5.     lab def prim_school               0 "Less than PS"           1 "PS or 
> more"
  6.     lab val prim_school               prim_school
  7.     lab def high_school               0 "Less than HS"           1 "HS or 
> more"
  8.     lab val high_school               high_school
  9.     lab def no_prenatal_care          1 "No prenatal care"       0 "Prenat
> al care"
 10.     lab val no_prenatal_care          no_prenatal_care
 11.     lab def lowbirthweight            1 "Low birth weight"       0 "Normal
>  birth weight"
 12.     lab val lowbirthweight            lowbirthweight
 13.     lab def apgar1_low                1 "Low APGAR score"        0 "Normal
>  APGAR score"
 14.     lab val apgar1_low                apgar1_low
 15.     lab def apgar2_low                1 "Low APGAR score"        0 "Normal
>  APGAR score"
 16.     lab val apgar2_low                apgar2_low
 17.     lab def preg_preterm              1 "Pre-term birth"         0 "Full-t
> erm birth"
 18.     lab val preg_preterm              preg_preterm
 19.     lab def first_pregnancy           0 "Not first pregnancy"    1 "First 
> pregnancy"
 20.     lab val first_pregnancy           first_pregnancy
 21.     lab def recomm_prenatal_numvisits 0 "No prenatal care"       1 "Prenat
> al care"
 22.     lab val recomm_prenatal_numvisits recomm_prenatal_numvisits
 23.     lab def recomm_prenatal_1stvisit  0 "No prenatal care"       1 "Prenat
> al care"
 24.     lab val recomm_prenatal_1stvisit  recomm_prenatal_1stvisit
 25.     label_geo
 26. end

. 
. program label_geo
  1.     label var    dpto_residence "Mother's residential state"
  2.     label var    dpto "Birth state"
  3.     label define dpto  1 "MONTEVIDEO" ///
>                            2 "ARTIGAS" ///
>                                            3 "CANELONES" ///
>                         4 "CERRO LARGO" ///
>                         5 "COLONIA" ///
>                         6 "DURAZNO" ///
>                         7 "FLORES" ///
>                         8 "FLORIDA" ///
>                         9 "LAVALLEJA" ///
>                         10 "MALDONADO" ///
>                         11 "PAYSANDU" ///
>                         12 "RÍO NEGRO" ///
>                         13 "RIVERA" ///
>                         14 "ROCHA" ///
>                         15 "SALTO" ///
>                         16 "SAN JOSÉ" ///
>                         17 "SORIANO" ///
>                         18 "TACUAREMBÓ" ///
>                         19 "TREINTA Y TRES"
  4.     label values dpto dpto
  5.     label values dpto_residence dpto
  6. end

. 
. main
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000001.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000002.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000003.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000004.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000005.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000006.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000007.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000008.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_02000009.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_0200000a.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_0200000b.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_0200000c.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_0200000d.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_0200000e.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_0200000f.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_0200000g.tmp saved
file C:\Users\dgentil1\AppData\Local\Temp\ST_0200000h.tmp saved
(note: variable fecparto was str6, now str7 to accommodate using data's
       values)
(note: variable fecparto was str7, now str8 to accommodate using data's
       values)
(1,247 observations deleted)
(note: file ../temp/births_append.dta not found)
file ../temp/births_append.dta saved
(629,119 missing values generated)
(424,674 real changes made)
(204,314 real changes made)
(617,773 missing values generated)
(326,317 real changes made)
(289,707 real changes made)
(51,908 missing values generated)
(51,908 missing values generated)
(51,908 missing values generated)
(51,908 missing values generated)
(51,908 missing values generated)
(2,651 real changes made)
(28 observations deleted)
(32,731 real changes made)
(31,821 real changes made)
(31,505 real changes made)
(32,843 real changes made)
(285,978 missing values generated)
(285,978 real changes made)
(10,915 missing values generated)
(52,685 missing values generated)
(10,915 missing values generated)
(5,192 missing values generated)
(5,192 missing values generated)
(4,941 missing values generated)
(9,170 missing values generated)
(9,188 missing values generated)
(13,795 missing values generated)
(7809 missing values generated)
(7809 missing values generated)
(7809 missing values generated)
(131 observations deleted)
(7,798 observations deleted)
(data now sorted by birth_id)
  variable dpto was float now byte
  variable dpto_residence was float now byte
  variable married was float now byte
  variable not_married was float now byte
  variable partner was float now byte
  variable no_partner was float now byte
  variable single was float now byte
  variable prim_school was float now byte
  variable high_school was float now byte
  variable anio_qtr was float now int
  variable anio_sem was float now int
  variable recomm_prenatal_numvisits was float now byte
  variable recomm_prenatal_1stvisit was float now byte
  variable no_prenatal_care was float now byte
  variable first_pregnancy was float now byte
  variable kids_before was float now byte
  variable lowbirthweight was float now byte
  variable apgar1_low was float now byte
  variable apgar2_low was float now byte
  variable preg_preterm was float now byte
  variable young was float now byte
  variable adult was float now byte
  variable age_group was float now byte
  variable age_min was float now byte
  variable age_max was float now byte
  variable public_health was float now byte
  variable pereira was float now byte
  (65,310,564 bytes saved)
===============================================================================
> ===================
File: ../output/vital_birth_records.dta
Key: birth_id
===============================================================================
> ===================
  826716:30(101881):314857364:2434746388

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    birth_id |    826,716    413421.2    238687.5          1     826836
        anio |    826,716     2006.86    4.967449       1999       2015
       edadm |    826,716    26.74744    6.697713         10         53
        dpto |    826,716    5.498114    5.884505          1         19
dpto_resid~e |    825,062    5.959725    5.834057          1         19
-------------+---------------------------------------------------------
     married |    775,715    .3600936    .4800276          0          1
 not_married |    775,715    .6399064    .4800276          0          1
     partner |    775,715    .7601284    .4270052          0          1
  no_partner |    775,715    .2398716    .4270052          0          1
      single |    775,715    .3237826    .4679185          0          1
-------------+---------------------------------------------------------
 prim_school |    826,716    .6226903    .4847137          0          1
 high_school |    826,716    .1598759    .3664912          0          1
    anio_qtr |    826,716     188.927    19.90053        156        223
    anio_sem |    826,716    94.21575    9.947281         78        111
recomm_pre~s |    816,036    .8047206    .3964159          0          1
-------------+---------------------------------------------------------
recomm_pre~t |    775,089    .5479913    .4976918          0          1
no_prenata~e |    816,036    .0385743    .1925782          0          1
first_preg~y |    821,587    .3747175    .4840502          0          1
 kids_before |    821,587    .6252825    .4840502          0          1
lowbirthwe~t |    822,191    .0820308    .2744118          0          1
-------------+---------------------------------------------------------
  apgar1_low |    818,085     .046082    .2096629          0          1
  apgar2_low |    818,066    .0100432    .0997113          0          1
preg_preterm |    813,527    .0921174    .2891918          0          1
       young |    826,716    .6901584    .4624284          0          1
       adult |    826,716    .3042133    .4600737          0          1
-------------+---------------------------------------------------------
   age_group |    826,716     24.7537     6.84487         10         50
     age_min |    826,716     24.7537     6.84487         10         50
     age_max |    826,716    28.75364    6.844668         14         53
public_hea~h |    826,716    .4162385    .4929344          0          1
     pereira |    826,716    .1560935    .3629442          0          1




(note: file ../output/vital_birth_records.dta not found)
file ../output/vital_birth_records.dta saved

. 
end of do-file

 make.py ended: 2020-03-07 16:49:16
